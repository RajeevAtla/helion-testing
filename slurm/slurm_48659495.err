INFO:    underlay of /usr/bin/nvidia-cuda-mps-control required more than 50 (480) bind mounts
15:4: not a valid test operator:  
15:4: not a valid test operator: 13.0
21:4: not a valid test operator: (
21:4: not a valid test operator: 535.154.05
downloading uv 0.9.15 x86_64-unknown-linux-gnu
[31mWARN(B[m: The following commands are shadowed by other commands in your PATH: uv uvx
Resolved 46 packages in 4ms
Audited 41 packages in 296ms
Testing helion correctness...
[0s] Autotune random seed: 42
[713s] Timeout after 300s compiling Config(block_sizes=[128], indexing=['block_ptr', 'pointer', 'block_ptr', 'pointer', 'block_ptr', 'block_ptr'], load_eviction_policies=['last', 'first', 'last', ''], num_stages=3, num_warps=4, pid_type='persistent_blocked', range_flattens=[None], range_multi_buffers=[True], range_num_stages=[4], range_unroll_factors=[2], range_warp_specializes=[], reduction_loops=[1024])
[713s] Timeout after 300s compiling Config(block_sizes=[64], indexing=['pointer', 'block_ptr', 'pointer', 'pointer', 'pointer', 'pointer'], load_eviction_policies=['first', 'last', 'last', 'first'], num_stages=5, num_warps=2, pid_type='persistent_blocked', range_flattens=[False], range_multi_buffers=[False], range_num_stages=[4], range_unroll_factors=[2], range_warp_specializes=[], reduction_loops=[1024])
[714s] Timeout after 300s compiling Config(block_sizes=[512], indexing=['pointer', 'block_ptr', 'pointer', 'pointer', 'block_ptr', 'block_ptr'], load_eviction_policies=['', 'first', 'last', ''], num_stages=5, num_warps=16, pid_type='persistent_interleaved', range_flattens=[True], range_multi_buffers=[None], range_num_stages=[4], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[512])
[715s] Timeout after 300s compiling Config(block_sizes=[128], indexing=['block_ptr', 'block_ptr', 'pointer', 'pointer', 'block_ptr', 'pointer'], load_eviction_policies=['first', 'last', 'last', ''], num_stages=8, num_warps=1, pid_type='persistent_interleaved', range_flattens=[False], range_multi_buffers=[False], range_num_stages=[1], range_unroll_factors=[1], range_warp_specializes=[], reduction_loops=[256])
[716s] Timeout after 300s compiling Config(block_sizes=[32], indexing=['block_ptr', 'pointer', 'pointer', 'block_ptr', 'block_ptr', 'pointer'], load_eviction_policies=['', 'first', '', ''], num_stages=7, num_warps=2, pid_type='persistent_blocked', range_flattens=[None], range_multi_buffers=[False], range_num_stages=[3], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[1024])
[720s] Timeout after 300s compiling Config(block_sizes=[1024], indexing=['block_ptr', 'block_ptr', 'pointer', 'block_ptr', 'block_ptr', 'block_ptr'], load_eviction_policies=['last', 'first', 'last', ''], num_stages=3, num_warps=8, pid_type='persistent_blocked', range_flattens=[False], range_multi_buffers=[False], range_num_stages=[2], range_unroll_factors=[2], range_warp_specializes=[], reduction_loops=[128])
[728s] Timeout after 300s compiling Config(block_sizes=[64], indexing=['block_ptr', 'block_ptr', 'block_ptr', 'block_ptr', 'pointer', 'block_ptr'], load_eviction_policies=['last', '', 'last', 'first'], num_stages=8, num_warps=1, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[512])
[740s] Timeout after 300s compiling Config(block_sizes=[128], indexing=['block_ptr', 'pointer', 'block_ptr', 'pointer', 'block_ptr', 'block_ptr'], load_eviction_policies=['last', '', 'first', 'first'], num_stages=2, num_warps=1, pid_type='persistent_interleaved', range_flattens=[False], range_multi_buffers=[False], range_num_stages=[0], range_unroll_factors=[4], range_warp_specializes=[], reduction_loops=[128])
[740s] Timeout after 300s compiling Config(block_sizes=[256], indexing=['block_ptr', 'block_ptr', 'pointer', 'pointer', 'pointer', 'pointer'], load_eviction_policies=['first', 'first', '', 'first'], num_stages=7, num_warps=2, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[128])
[744s] Timeout after 300s compiling Config(block_sizes=[2048], indexing=['pointer', 'block_ptr', 'pointer', 'block_ptr', 'pointer', 'pointer'], load_eviction_policies=['last', 'first', '', ''], num_stages=7, num_warps=16, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[256])
[753s] Timeout after 300s compiling Config(block_sizes=[512], indexing=['pointer', 'pointer', 'pointer', 'block_ptr', 'block_ptr', 'pointer'], load_eviction_policies=['first', '', 'first', 'first'], num_stages=2, num_warps=2, pid_type='persistent_blocked', range_flattens=[False], range_multi_buffers=[False], range_num_stages=[2], range_unroll_factors=[3], range_warp_specializes=[], reduction_loops=[256])
[754s] Timeout after 300s compiling Config(block_sizes=[128], indexing=['block_ptr', 'block_ptr', 'pointer', 'block_ptr', 'pointer', 'block_ptr'], load_eviction_policies=['', 'last', '', 'first'], num_stages=2, num_warps=2, pid_type='persistent_blocked', range_flattens=[None], range_multi_buffers=[False], range_num_stages=[0], range_unroll_factors=[3], range_warp_specializes=[], reduction_loops=[256])
[758s] Timeout after 300s compiling Config(block_sizes=[32], indexing=['block_ptr', 'pointer', 'pointer', 'block_ptr', 'pointer', 'block_ptr'], load_eviction_policies=['first', '', '', ''], num_stages=5, num_warps=4, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[2048])
[772s] Timeout after 300s compiling Config(block_sizes=[256], indexing=['pointer', 'pointer', 'block_ptr', 'pointer', 'block_ptr', 'pointer'], load_eviction_policies=['first', 'last', '', 'last'], num_stages=6, num_warps=2, pid_type='persistent_blocked', range_flattens=[None], range_multi_buffers=[False], range_num_stages=[0], range_unroll_factors=[2], range_warp_specializes=[], reduction_loops=[512])
[785s] Timeout after 300s compiling Config(block_sizes=[512], indexing=['block_ptr', 'block_ptr', 'pointer', 'pointer', 'block_ptr', 'pointer'], load_eviction_policies=['last', 'last', 'first', ''], num_stages=8, num_warps=16, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[512])
[800s] Timeout after 300s compiling Config(block_sizes=[2048], indexing=['block_ptr', 'pointer', 'pointer', 'block_ptr', 'pointer', 'block_ptr'], load_eviction_policies=['first', 'last', 'first', 'last'], num_stages=5, num_warps=8, pid_type='persistent_blocked', range_flattens=[False], range_multi_buffers=[None], range_num_stages=[1], range_unroll_factors=[3], range_warp_specializes=[], reduction_loops=[64])
[802s] Timeout after 300s compiling Config(block_sizes=[64], indexing=['block_ptr', 'block_ptr', 'pointer', 'block_ptr', 'block_ptr', 'pointer'], load_eviction_policies=['', '', '', 'last'], num_stages=2, num_warps=2, pid_type='persistent_interleaved', range_flattens=[True], range_multi_buffers=[None], range_num_stages=[2], range_unroll_factors=[3], range_warp_specializes=[], reduction_loops=[512])
Traceback (most recent call last):
  File "/scratch/rra80/helion-testing/.venv/lib/python3.13/site-packages/helion/autotuner/base_search.py", line 663, in autotune
    best = self._autotune()
  File "/scratch/rra80/helion-testing/.venv/lib/python3.13/site-packages/helion/autotuner/finite_search.py", line 38, in _autotune
    for result in self.parallel_benchmark(self.configs, desc="Benchmarking"):
                  ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/rra80/helion-testing/.venv/lib/python3.13/site-packages/helion/autotuner/base_search.py", line 575, in parallel_benchmark
    is_workings = PrecompileFuture.wait_for_all(futures, desc=precompile_desc)
  File "/scratch/rra80/helion-testing/.venv/lib/python3.13/site-packages/helion/autotuner/base_search.py", line 1135, in wait_for_all
    remaining = PrecompileFuture._wait_for_all_step(remaining)
  File "/scratch/rra80/helion-testing/.venv/lib/python3.13/site-packages/helion/autotuner/base_search.py", line 1162, in _wait_for_all_step
    job.start()
    ~~~~~~~~~^^
  File "/scratch/rra80/helion-testing/.venv/lib/python3.13/site-packages/helion/autotuner/base_search.py", line 1071, in start
    self.process.start()
    ~~~~~~~~~~~~~~~~~~^^
  File "/home/rra80/.local/share/uv/python/cpython-3.13.9-linux-x86_64-gnu/lib/python3.13/multiprocessing/process.py", line 121, in start
    self._popen = self._Popen(self)
                  ~~~~~~~~~~~^^^^^^
  File "/home/rra80/.local/share/uv/python/cpython-3.13.9-linux-x86_64-gnu/lib/python3.13/multiprocessing/context.py", line 282, in _Popen
    return Popen(process_obj)
  File "/home/rra80/.local/share/uv/python/cpython-3.13.9-linux-x86_64-gnu/lib/python3.13/multiprocessing/popen_fork.py", line 20, in __init__
    self._launch(process_obj)
    ~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/rra80/.local/share/uv/python/cpython-3.13.9-linux-x86_64-gnu/lib/python3.13/multiprocessing/popen_fork.py", line 66, in _launch
    child_r, parent_w = os.pipe()
                        ~~~~~~~^^
OSError: [Errno 24] Too many open files

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/scratch/rra80/helion-testing/main.py", line 79, in <module>
    main()
    ~~~~^^
  File "/scratch/rra80/helion-testing/main.py", line 74, in main
    check(4096, 4096)
    ~~~~~^^^^^^^^^^^^
  File "/scratch/rra80/helion-testing/main.py", line 66, in check
    run_example(softmax, lambda x: torch.nn.functional.softmax(x, dim=1), (x,))
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/rra80/helion-testing/.venv/lib/python3.13/site-packages/helion/_testing.py", line 622, in run_example
    func(*args).to(torch.float32),
    ~~~~^^^^^^^
  File "/scratch/rra80/helion-testing/.venv/lib/python3.13/site-packages/helion/runtime/kernel.py", line 340, in __call__
    return self.bind(args)(*args)
           ~~~~~~~~~~~~~~~^^^^^^^
  File "/scratch/rra80/helion-testing/.venv/lib/python3.13/site-packages/helion/runtime/kernel.py", line 706, in __call__
    self.autotune(args, force=False)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/scratch/rra80/helion-testing/.venv/lib/python3.13/site-packages/helion/runtime/kernel.py", line 584, in autotune
    config = self.settings.autotuner_fn(self, args, **kwargs).autotune(
        skip_cache=force
    )
  File "/scratch/rra80/helion-testing/.venv/lib/python3.13/site-packages/helion/autotuner/base_cache.py", line 181, in autotune
    return self.autotuner.autotune()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/scratch/rra80/helion-testing/.venv/lib/python3.13/site-packages/helion/autotuner/base_search.py", line 647, in autotune
    with exit_stack:
         ^^^^^^^^^^
  File "/home/rra80/.local/share/uv/python/cpython-3.13.9-linux-x86_64-gnu/lib/python3.13/contextlib.py", line 619, in __exit__
    raise exc
  File "/home/rra80/.local/share/uv/python/cpython-3.13.9-linux-x86_64-gnu/lib/python3.13/contextlib.py", line 604, in __exit__
    if cb(*exc_details):
       ~~^^^^^^^^^^^^^^
  File "/home/rra80/.local/share/uv/python/cpython-3.13.9-linux-x86_64-gnu/lib/python3.13/contextlib.py", line 482, in _exit_wrapper
    callback(*args, **kwds)
    ~~~~~~~~^^^^^^^^^^^^^^^
  File "/scratch/rra80/helion-testing/.venv/lib/python3.13/site-packages/helion/autotuner/base_search.py", line 153, in cleanup
    self._precompile_tmpdir.cleanup()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/home/rra80/.local/share/uv/python/cpython-3.13.9-linux-x86_64-gnu/lib/python3.13/tempfile.py", line 955, in cleanup
    self._rmtree(self.name, ignore_errors=self._ignore_cleanup_errors)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/rra80/.local/share/uv/python/cpython-3.13.9-linux-x86_64-gnu/lib/python3.13/tempfile.py", line 935, in _rmtree
    _shutil.rmtree(name, onexc=onexc)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/home/rra80/.local/share/uv/python/cpython-3.13.9-linux-x86_64-gnu/lib/python3.13/shutil.py", line 763, in rmtree
    _rmtree_safe_fd(stack, onexc)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/home/rra80/.local/share/uv/python/cpython-3.13.9-linux-x86_64-gnu/lib/python3.13/shutil.py", line 707, in _rmtree_safe_fd
    onexc(func, path, err)
    ~~~~~^^^^^^^^^^^^^^^^^
  File "/home/rra80/.local/share/uv/python/cpython-3.13.9-linux-x86_64-gnu/lib/python3.13/shutil.py", line 682, in _rmtree_safe_fd
    with os.scandir(topfd) as scandir_it:
         ~~~~~~~~~~^^^^^^^
OSError: [Errno 24] Too many open files: '/tmp/tmpicddhqr8'
Exception ignored in atexit callback <bound method TemporaryDirectory.cleanup of <TemporaryDirectory '/tmp/tmpyfyjrw9t'>>:
Traceback (most recent call last):
  File "/home/rra80/.local/share/uv/python/cpython-3.13.9-linux-x86_64-gnu/lib/python3.13/tempfile.py", line 955, in cleanup
    self._rmtree(self.name, ignore_errors=self._ignore_cleanup_errors)
  File "/home/rra80/.local/share/uv/python/cpython-3.13.9-linux-x86_64-gnu/lib/python3.13/tempfile.py", line 935, in _rmtree
    _shutil.rmtree(name, onexc=onexc)
  File "/home/rra80/.local/share/uv/python/cpython-3.13.9-linux-x86_64-gnu/lib/python3.13/shutil.py", line 763, in rmtree
    _rmtree_safe_fd(stack, onexc)
  File "/home/rra80/.local/share/uv/python/cpython-3.13.9-linux-x86_64-gnu/lib/python3.13/shutil.py", line 707, in _rmtree_safe_fd
    onexc(func, path, err)
  File "/home/rra80/.local/share/uv/python/cpython-3.13.9-linux-x86_64-gnu/lib/python3.13/shutil.py", line 682, in _rmtree_safe_fd
    with os.scandir(topfd) as scandir_it:
OSError: [Errno 24] Too many open files: '/tmp/tmpyfyjrw9t'
slurmstepd: error: *** JOB 48659495 ON gpuk005 CANCELLED AT 2025-12-06T11:32:15 DUE TO TIME LIMIT ***
