INFO:    underlay of /usr/bin/nvidia-smi required more than 50 (480) bind mounts
15:4: not a valid test operator:  
15:4: not a valid test operator: 13.0
21:4: not a valid test operator: (
21:4: not a valid test operator: 535.154.05
downloading uv 0.9.15 x86_64-unknown-linux-gnu
[31mWARN(B[m: The following commands are shadowed by other commands in your PATH: uv uvx
Resolved 46 packages in 7ms
Audited 41 packages in 387ms
Testing helion correctness...
[0s] Autotune random seed: 42
[2s] Starting autotuning process, this may take a while...
[0s] Starting PatternSearch with initial_population=100, copies=5, max_generations=20
[62s] Timeout after 60s compiling Config(block_sizes=[64], indexing=['pointer', 'pointer', 'block_ptr', 'pointer', 'pointer', 'pointer'], load_eviction_policies=['', 'first', 'last', 'last'], num_stages=2, num_warps=2, pid_type='persistent_interleaved', range_flattens=[None], range_multi_buffers=[True], range_num_stages=[0], range_unroll_factors=[1], range_warp_specializes=[], reduction_loops=[512])
[62s] Timeout after 60s compiling Config(block_sizes=[64], indexing=['pointer', 'block_ptr', 'pointer', 'block_ptr', 'pointer', 'pointer'], load_eviction_policies=['first', '', 'last', 'first'], num_stages=7, num_warps=1, pid_type='persistent_blocked', range_flattens=[True], range_multi_buffers=[True], range_num_stages=[3], range_unroll_factors=[2], range_warp_specializes=[], reduction_loops=[256])
[63s] Timeout after 60s compiling Config(block_sizes=[64], indexing=['block_ptr', 'block_ptr', 'block_ptr', 'pointer', 'block_ptr', 'pointer'], load_eviction_policies=['', 'first', 'last', 'last'], num_stages=6, num_warps=8, pid_type='persistent_interleaved', range_flattens=[None], range_multi_buffers=[False], range_num_stages=[2], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[2048])
[63s] Timeout after 60s compiling Config(block_sizes=[512], indexing=['pointer', 'pointer', 'pointer', 'pointer', 'block_ptr', 'pointer'], load_eviction_policies=['first', 'last', 'last', ''], num_stages=4, num_warps=2, pid_type='persistent_blocked', range_flattens=[False], range_multi_buffers=[True], range_num_stages=[1], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[256])
[63s] Timeout after 60s compiling Config(block_sizes=[128], indexing=['block_ptr', 'block_ptr', 'pointer', 'block_ptr', 'block_ptr', 'block_ptr'], load_eviction_policies=['last', 'last', 'last', 'last'], num_stages=1, num_warps=8, pid_type='persistent_blocked', range_flattens=[False], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[3], range_warp_specializes=[], reduction_loops=[512])
[63s] Timeout after 60s compiling Config(block_sizes=[512], indexing=['block_ptr', 'block_ptr', 'block_ptr', 'pointer', 'block_ptr', 'pointer'], load_eviction_policies=['first', '', 'first', 'first'], num_stages=1, num_warps=1, pid_type='persistent_blocked', range_flattens=[True], range_multi_buffers=[True], range_num_stages=[2], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[32])
[63s] Timeout after 60s compiling Config(block_sizes=[128], indexing=['block_ptr', 'block_ptr', 'block_ptr', 'block_ptr', 'block_ptr', 'pointer'], load_eviction_policies=['last', '', 'first', ''], num_stages=6, num_warps=16, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[2048])
[63s] Timeout after 60s compiling Config(block_sizes=[512], indexing=['block_ptr', 'pointer', 'pointer', 'pointer', 'pointer', 'block_ptr'], load_eviction_policies=['', '', '', ''], num_stages=7, num_warps=16, pid_type='persistent_interleaved', range_flattens=[False], range_multi_buffers=[False], range_num_stages=[3], range_unroll_factors=[3], range_warp_specializes=[], reduction_loops=[256])
[65s] Timeout after 60s compiling Config(block_sizes=[512], indexing=['pointer', 'block_ptr', 'block_ptr', 'pointer', 'block_ptr', 'pointer'], load_eviction_policies=['', 'last', 'first', 'last'], num_stages=1, num_warps=4, pid_type='persistent_interleaved', range_flattens=[False], range_multi_buffers=[True], range_num_stages=[0], range_unroll_factors=[2], range_warp_specializes=[], reduction_loops=[128])
[66s] Timeout after 60s compiling Config(block_sizes=[2048], indexing=['pointer', 'pointer', 'pointer', 'block_ptr', 'block_ptr', 'pointer'], load_eviction_policies=['first', 'first', 'first', 'first'], num_stages=7, num_warps=8, pid_type='persistent_blocked', range_flattens=[False], range_multi_buffers=[True], range_num_stages=[4], range_unroll_factors=[3], range_warp_specializes=[], reduction_loops=[256])
[67s] Timeout after 60s compiling Config(block_sizes=[512], indexing=['pointer', 'block_ptr', 'block_ptr', 'block_ptr', 'block_ptr', 'block_ptr'], load_eviction_policies=['last', 'first', '', ''], num_stages=8, num_warps=4, pid_type='persistent_interleaved', range_flattens=[None], range_multi_buffers=[True], range_num_stages=[1], range_unroll_factors=[3], range_warp_specializes=[], reduction_loops=[128])
[68s] Timeout after 60s compiling Config(block_sizes=[512], indexing=['pointer', 'pointer', 'block_ptr', 'block_ptr', 'pointer', 'block_ptr'], load_eviction_policies=['last', 'first', '', 'last'], num_stages=1, num_warps=16, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[512])
[69s] Timeout after 60s compiling Config(block_sizes=[512], indexing=['pointer', 'block_ptr', 'pointer', 'pointer', 'pointer', 'pointer'], load_eviction_policies=['first', '', 'first', 'last'], num_stages=3, num_warps=4, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[128])
[70s] Timeout after 60s compiling Config(block_sizes=[32], indexing=['block_ptr', 'block_ptr', 'block_ptr', 'block_ptr', 'pointer', 'pointer'], load_eviction_policies=['last', '', 'first', 'first'], num_stages=5, num_warps=1, pid_type='persistent_blocked', range_flattens=[None], range_multi_buffers=[True], range_num_stages=[1], range_unroll_factors=[4], range_warp_specializes=[], reduction_loops=[1024])
[77s] Initial random population of 100, 5 starting points: timeout=14 ok=86 min=0.0358 mid=0.2212 max=9.1761 best=Config(block_sizes=[1], indexing=['block_ptr', 'block_ptr', 'pointer', 'block_ptr', 'block_ptr', 'block_ptr'], load_eviction_policies=['last', 'last', '', ''], num_stages=7, num_warps=1, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None])
[77s] Generation 1 starting: 124 neighbors, 5 active search path(s)
[106s] Generation 1 complete: ok=129 min=0.0307 mid=0.0532 max=0.1792 best=Config(block_sizes=[1], indexing=['block_ptr', 'block_ptr', 'pointer', 'block_ptr', 'block_ptr', 'block_ptr'], load_eviction_policies=['', 'last', '', ''], num_stages=7, num_warps=1, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None])
[106s] Generation 2 starting: 106 neighbors, 5 active search path(s)
[131s] Generation 2 complete: ok=111 min=0.0307 mid=0.0420 max=0.1587 best=Config(block_sizes=[1], indexing=['block_ptr', 'block_ptr', 'pointer', 'block_ptr', 'block_ptr', 'block_ptr'], load_eviction_policies=['', 'last', '', ''], num_stages=7, num_warps=1, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None])
[131s] Generation 3 starting: 86 neighbors, 4 active search path(s)
[155s] Generation 3 complete: ok=91 min=0.0297 mid=0.0399 max=0.1505 best=Config(block_sizes=[1], indexing=['block_ptr', 'pointer', 'pointer', 'pointer', 'pointer', 'pointer'], load_eviction_policies=['first', '', '', ''], num_stages=1, num_warps=2, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None])
[155s] Generation 4 starting: 62 neighbors, 3 active search path(s)
[171s] Generation 4 complete: ok=65 min=0.0297 mid=0.0399 max=0.1157 best=Config(block_sizes=[1], indexing=['block_ptr', 'pointer', 'pointer', 'pointer', 'pointer', 'pointer'], load_eviction_policies=['first', '', '', ''], num_stages=1, num_warps=2, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None])
[171s] Autotuning complete in 171.5s after searching 464 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[1], indexing=['block_ptr', 'pointer', 'pointer', 'pointer', 'pointer', 'pointer'], load_eviction_policies=['first', '', '', ''], num_stages=1, num_warps=2, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None]), static_shapes=True)


=================================================================
Benchmark Results
=================================================================
Implementation       Time (ms)    Speedup        
-----------------------------------------------------------------
helion               0.0369       2.14x          
torch                0.0788       1.00x (ref)    
=================================================================

